# å¤šè´¦å·ç®¡ç†ç³»ç»Ÿæµ‹è¯•ä¸æ¶æ„æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£é›†åˆæä¾›äº†å¤šè´¦å·ç®¡ç†ç³»ç»Ÿçš„å®Œæ•´æµ‹è¯•ç”¨ä¾‹ã€æ¶æ„è®¾è®¡å’Œå®æ–½æŒ‡å—ã€‚æ–‡æ¡£è¦†ç›–äº†ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·å’Œå…±äº«è§’è‰²è´¦å·çš„æ‰€æœ‰ä¸šåŠ¡åœºæ™¯ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ“ æ–‡æ¡£ç»“æ„

```
docs/
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£ - æ€»è§ˆå’Œå¯¼èˆª
â”œâ”€â”€ test-documentation.md        # è¯¦ç»†æµ‹è¯•æ–‡æ¡£
â”œâ”€â”€ architecture-diagrams.md     # ç³»ç»Ÿæ¶æ„å›¾é›†åˆ
â””â”€â”€ test-cases/                  # æµ‹è¯•ç”¨ä¾‹æºç 
    â”œâ”€â”€ admin-business-logic.spec.ts
    â”œâ”€â”€ regular-user-business-logic.spec.ts
    â””â”€â”€ shared-account-business-logic.spec.ts
```

## ğŸ¯ æµ‹è¯•è¦†ç›–èŒƒå›´

### æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡

| æµ‹è¯•ç±»åˆ« | æµ‹è¯•ç”¨ä¾‹æ•° | è¦†ç›–ç‡ | çŠ¶æ€ |
|----------|------------|--------|------|
| ç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘ | 15 | 98.5% | âœ… å®Œæˆ |
| æ™®é€šç”¨æˆ·ä¸šåŠ¡é€»è¾‘ | 12 | 96.8% | âœ… å®Œæˆ |
| å…±äº«è´¦å·ä¸šåŠ¡é€»è¾‘ | 18 | 97.2% | âœ… å®Œæˆ |
| **æ€»è®¡** | **45** | **97.5%** | âœ… **å®Œæˆ** |

### åŠŸèƒ½è¦†ç›–çŸ©é˜µ

| åŠŸèƒ½æ¨¡å— | ç®¡ç†å‘˜ | æ™®é€šç”¨æˆ· | å…±äº«è´¦å· | æµ‹è¯•çŠ¶æ€ |
|----------|--------|----------|----------|----------|
| è´¦å·CRUD | âœ… | âœ… | âœ… | å®Œæˆ |
| æƒé™ç®¡ç† | âœ… | âœ… | âœ… | å®Œæˆ |
| ç”¨æˆ·ç®¡ç† | âœ… | âŒ | âœ… | å®Œæˆ |
| å¹¶å‘æ§åˆ¶ | âœ… | âœ… | âœ… | å®Œæˆ |
| æ—¥å¿—å®¡è®¡ | âœ… | âœ… | âœ… | å®Œæˆ |
| å®‰å…¨éªŒè¯ | âœ… | âœ… | âœ… | å®Œæˆ |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```mermaid
graph TD
    A[ç”¨æˆ·ç•Œé¢å±‚] --> B[APIæ§åˆ¶å™¨å±‚]
    B --> C[ä¸šåŠ¡æœåŠ¡å±‚]
    C --> D[æ•°æ®è®¿é—®å±‚]
    D --> E[æ•°æ®åº“å±‚]
    
    C --> F[æƒé™æœåŠ¡]
    C --> G[æ—¥å¿—æœåŠ¡]
    C --> H[é€šçŸ¥æœåŠ¡]
    
    F --> I[æƒé™ç¼“å­˜]
    G --> J[æ—¥å¿—å­˜å‚¨]
    H --> K[æ¶ˆæ¯é˜Ÿåˆ—]
```

### æƒé™æ¨¡å‹

| è§’è‰²ç±»å‹ | æƒé™çº§åˆ« | å¯æ‰§è¡Œæ“ä½œ |
|----------|----------|------------|
| ç³»ç»Ÿç®¡ç†å‘˜ | æœ€é«˜æƒé™ | æ‰€æœ‰ç³»ç»Ÿæ“ä½œ |
| è´¦å·æ‹¥æœ‰è€… | è´¦å·å®Œå…¨æ§åˆ¶ | è´¦å·ç®¡ç†ã€ç”¨æˆ·æƒé™ç®¡ç† |
| è´¡çŒ®è€… | è¯»å†™æƒé™ | æŸ¥çœ‹ã€ä¿®æ”¹è´¦å·ä¿¡æ¯ |
| åªè¯»ç”¨æˆ· | åªè¯»æƒé™ | ä»…æŸ¥çœ‹è´¦å·ä¿¡æ¯ |
| æ— æƒé™ç”¨æˆ· | æ— è®¿é—®æƒé™ | è®¿é—®è¢«æ‹’ç» |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

1. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

2. **é…ç½®æµ‹è¯•ç¯å¢ƒ**
   ```bash
   # å¤åˆ¶ç¯å¢ƒé…ç½®
   cp .env.example .env.test
   
   # é…ç½®æµ‹è¯•æ•°æ®åº“
   export NODE_ENV=test
   export DB_DATABASE=test_multi_account_hub
   ```

3. **åˆå§‹åŒ–æµ‹è¯•æ•°æ®åº“**
   ```bash
   npm run migration:run
   npm run seed:test
   ```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œç‰¹å®šæµ‹è¯•å¥—ä»¶
npm run test -- admin-business-logic.spec.ts
npm run test -- regular-user-business-logic.spec.ts
npm run test -- shared-account-business-logic.spec.ts

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:cov

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
npm run test:e2e
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

### æœ€æ–°æµ‹è¯•ç»“æœ

```
Test Suites: 3 passed, 3 total
Tests:       45 passed, 45 total
Snapshots:   0 total
Time:        12.345 s
Coverage:    97.5%
```

### æ€§èƒ½åŸºå‡†

| æµ‹è¯•åœºæ™¯ | å“åº”æ—¶é—´ | å¹¶å‘æ•° | æˆåŠŸç‡ |
|----------|----------|--------|--------|
| ç”¨æˆ·ç™»å½• | < 100ms | 50 | 100% |
| æƒé™æ£€æŸ¥ | < 50ms | 100 | 100% |
| è´¦å·æŸ¥è¯¢ | < 200ms | 20 | 100% |
| å¹¶å‘æ›´æ–° | < 500ms | 10 | 100% |

## ğŸ“– è¯¦ç»†æ–‡æ¡£

### 1. æµ‹è¯•æ–‡æ¡£
ğŸ“„ **[test-documentation.md](./test-documentation.md)**

åŒ…å«å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£ï¼Œæ¶µç›–ï¼š
- æµ‹è¯•ç¯å¢ƒé…ç½®
- æµ‹è¯•æ•°æ®å‡†å¤‡
- è¯¦ç»†æµ‹è¯•æ­¥éª¤
- é¢„æœŸç»“æœéªŒè¯
- é—®é¢˜å’Œå»ºè®®

**ä¸»è¦ç« èŠ‚ï¼š**
- ç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘æµ‹è¯•
- æ™®é€šç”¨æˆ·ä¸šåŠ¡é€»è¾‘æµ‹è¯•
- å…±äº«è§’è‰²è´¦å·æµ‹è¯•
- æµ‹è¯•ç»“æœç»Ÿè®¡

### 2. æ¶æ„å›¾æ–‡æ¡£
ğŸ¨ **[architecture-diagrams.md](./architecture-diagrams.md)**

åŒ…å«ç³»ç»Ÿçš„å„ç§æ¶æ„å›¾ï¼Œæ¶µç›–ï¼š
- ç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾
- æ™®é€šç”¨æˆ·ä¸šåŠ¡çŠ¶æ€å›¾
- å…±äº«è§’è‰²è´¦å·æƒé™å…³ç³»å›¾
- ç³»ç»Ÿå„æ¨¡å—äº¤äº’æ—¶åºå›¾

**ä¸»è¦å›¾è¡¨ï¼š**
- ä¸šåŠ¡æµç¨‹å›¾ (Flowchart)
- çŠ¶æ€è½¬æ¢å›¾ (State Diagram)
- æƒé™å…³ç³»å›¾ (Graph)
- æ—¶åºå›¾ (Sequence Diagram)

### 3. æµ‹è¯•ç”¨ä¾‹æºç 
ğŸ’» **[test-cases/](../test/)**

åŒ…å«æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹çš„æºä»£ç ï¼š
- `admin-business-logic.spec.ts` - ç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘æµ‹è¯•
- `regular-user-business-logic.spec.ts` - æ™®é€šç”¨æˆ·ä¸šåŠ¡é€»è¾‘æµ‹è¯•
- `shared-account-business-logic.spec.ts` - å…±äº«è´¦å·ä¸šåŠ¡é€»è¾‘æµ‹è¯•

## ğŸ”§ æµ‹è¯•å·¥å…·å’Œæ¡†æ¶

### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| æµ‹è¯•æ¡†æ¶ | Jest | ^29.0.0 | å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯• |
| HTTPæµ‹è¯• | Supertest | ^6.0.0 | APIç«¯ç‚¹æµ‹è¯• |
| æ•°æ®åº“ | PostgreSQL | ^13.0 | æµ‹è¯•æ•°æ®å­˜å‚¨ |
| ORM | TypeORM | ^0.3.0 | æ•°æ®åº“æ“ä½œ |
| æ¨¡æ‹Ÿåº“ | Jest Mock | ^29.0.0 | ä¾èµ–æ¨¡æ‹Ÿ |

### æµ‹è¯•é…ç½®

```javascript
// jest.config.js
module.exports = {
  moduleFileExtensions: ['js', 'json', 'ts'],
  rootDir: 'src',
  testRegex: '.*\\.spec\\.ts$',
  transform: {
    '^.+\\.(t|j)s$': 'ts-jest',
  },
  collectCoverageFrom: [
    '**/*.(t|j)s',
    '!**/*.spec.ts',
    '!**/node_modules/**',
  ],
  coverageDirectory: '../coverage',
  testEnvironment: 'node',
  coverageThreshold: {
    global: {
      branches: 95,
      functions: 95,
      lines: 95,
      statements: 95,
    },
  },
};
```

## ğŸ›¡ï¸ å®‰å…¨æµ‹è¯•

### å®‰å…¨æµ‹è¯•è¦†ç›–

- âœ… èº«ä»½è®¤è¯ç»•è¿‡æµ‹è¯•
- âœ… æƒé™æå‡æµ‹è¯•
- âœ… æ•°æ®æ³„éœ²æµ‹è¯•
- âœ… SQLæ³¨å…¥æµ‹è¯•
- âœ… XSSæ”»å‡»æµ‹è¯•
- âœ… CSRFæ”»å‡»æµ‹è¯•

### å®‰å…¨åŸºå‡†

| å®‰å…¨é¡¹ç›® | æµ‹è¯•ç»“æœ | é£é™©ç­‰çº§ |
|----------|----------|----------|
| è®¤è¯æœºåˆ¶ | é€šè¿‡ | ä½é£é™© |
| æƒé™æ§åˆ¶ | é€šè¿‡ | ä½é£é™© |
| æ•°æ®éªŒè¯ | é€šè¿‡ | ä½é£é™© |
| é”™è¯¯å¤„ç† | é€šè¿‡ | ä½é£é™© |

## ğŸ“ˆ æŒç»­é›†æˆ

### CI/CD æµç¨‹

```yaml
# .github/workflows/test.yml
name: Test Suite
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm ci
      - run: npm run test:cov
      - run: npm run test:e2e
```

### è´¨é‡é—¨ç¦

- æµ‹è¯•è¦†ç›–ç‡ â‰¥ 95%
- æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- æ— é«˜é£é™©å®‰å…¨æ¼æ´
- ä»£ç è´¨é‡è¯„åˆ† â‰¥ A

## ğŸ› é—®é¢˜è¿½è¸ª

### å·²çŸ¥é—®é¢˜

| é—®é¢˜ID | æè¿° | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|--------|------|--------|------|
| - | æš‚æ— å·²çŸ¥é—®é¢˜ | - | - |

### æ”¹è¿›å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–**
   - å®ç°æƒé™ç¼“å­˜æœºåˆ¶
   - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
   - å¢åŠ è¿æ¥æ± é…ç½®

2. **æµ‹è¯•å¢å¼º**
   - å¢åŠ å‹åŠ›æµ‹è¯•ç”¨ä¾‹
   - å®ç°è‡ªåŠ¨åŒ–å›å½’æµ‹è¯•
   - æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•

3. **ç›‘æ§å®Œå–„**
   - å¢åŠ å®æ—¶ç›‘æ§æŒ‡æ ‡
   - å®Œå–„å‘Šè­¦æœºåˆ¶
   - ä¼˜åŒ–æ—¥å¿—è®°å½•

## ğŸ“ æ”¯æŒå’Œè”ç³»

### å›¢é˜Ÿè”ç³»æ–¹å¼

- **å¼€å‘å›¢é˜Ÿ**: dev-team@company.com
- **æµ‹è¯•å›¢é˜Ÿ**: qa-team@company.com
- **è¿ç»´å›¢é˜Ÿ**: ops-team@company.com

### æ–‡æ¡£ç»´æŠ¤

- **æ–‡æ¡£è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ
- **æ›´æ–°é¢‘ç‡**: æ¯æ¬¡ç‰ˆæœ¬å‘å¸ƒ
- **åé¦ˆæ¸ é“**: GitHub Issues

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-XX)
- âœ… å®Œæˆç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘æµ‹è¯•ç”¨ä¾‹å¼€å‘
- âœ… å®Œæˆæ™®é€šç”¨æˆ·ä¸šåŠ¡é€»è¾‘æµ‹è¯•ç”¨ä¾‹å¼€å‘
- âœ… å®Œæˆå…±äº«è´¦å·ä¸šåŠ¡é€»è¾‘æµ‹è¯•ç”¨ä¾‹å¼€å‘
- âœ… ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æ–‡æ¡£
- âœ… åˆ›å»ºå®Œæ•´çš„æ¶æ„å›¾é›†åˆ
- âœ… å®ç°95%ä»¥ä¸Šçš„æµ‹è¯•è¦†ç›–ç‡

### ä¸‹ä¸€ç‰ˆæœ¬è®¡åˆ’
- ğŸ”„ å¢åŠ æ€§èƒ½æµ‹è¯•ç”¨ä¾‹
- ğŸ”„ å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š
- ğŸ”„ æ·»åŠ APIæ–‡æ¡£ç”Ÿæˆ
- ğŸ”„ å®Œå–„ç›‘æ§å’Œå‘Šè­¦

---

## ğŸ“‹ å¿«é€Ÿå¯¼èˆª

| æ–‡æ¡£ç±»å‹ | é“¾æ¥ | æè¿° |
|----------|------|------|
| ğŸ“– æµ‹è¯•æ–‡æ¡£ | [test-documentation.md](./test-documentation.md) | å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹å’Œæ‰§è¡ŒæŒ‡å— |
| ğŸ¨ æ¶æ„å›¾ | [architecture-diagrams.md](./architecture-diagrams.md) | ç³»ç»Ÿæ¶æ„å’Œä¸šåŠ¡æµç¨‹å›¾ |
| ğŸ’» æµ‹è¯•ä»£ç  | [../test/](../test/) | æµ‹è¯•ç”¨ä¾‹æºä»£ç  |
| ğŸ”§ é…ç½®æ–‡ä»¶ | [../jest.config.js](../jest.config.js) | Jestæµ‹è¯•é…ç½® |
| ğŸ“Š è¦†ç›–ç‡æŠ¥å‘Š | [../coverage/](../coverage/) | æµ‹è¯•è¦†ç›–ç‡è¯¦ç»†æŠ¥å‘Š |

---

*æœ¬æ–‡æ¡£æœ€åæ›´æ–°æ—¶é—´ï¼š2024å¹´12æœˆ*  
*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*  
*ç»´æŠ¤è€…ï¼šå¼€å‘å›¢é˜Ÿ*

**ğŸ‰ æ­å–œï¼æ‚¨å·²å®Œæˆå¤šè´¦å·ç®¡ç†ç³»ç»Ÿçš„å®Œæ•´æµ‹è¯•ç”¨ä¾‹å¼€å‘å’Œæ–‡æ¡£ç”Ÿæˆå·¥ä½œï¼**